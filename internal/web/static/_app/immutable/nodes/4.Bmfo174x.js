import{d as Se,a as S,f as D,s as x,c as W}from"../chunks/Bph8Cap9.js";import{l as Ce,k as N,e as ve,G as De,I as Ae,J as Ie,K as Le,w as Oe,p as Te,b as C,d as le,h as Ee,i as d,g as t,a as Ke,c as s,s as i,$ as Re,r,u as qe,t as E}from"../chunks/B8-RBE8K.js";import{i as J}from"../chunks/Cv1hhGhC.js";import{e as de,i as ne,r as ce,C as Me,b as je}from"../chunks/Dup_7zzF.js";import{h as Pe}from"../chunks/DN4icXi7.js";import{b as ue}from"../chunks/ByCfWYC6.js";import{c as $e,d as Fe,g as Ze,e as Be}from"../chunks/EFiNwc8y.js";function pe(o,v,c=!1){if(o.multiple){if(v==null)return;if(!Ae(v))return Ie();for(var p of o.options)p.selected=v.includes(K(p));return}for(p of o.options){var f=K(p);if(Le(f,v)){p.selected=!0;return}}(!c||v!==void 0)&&(o.selectedIndex=-1)}function Ge(o){var v=new MutationObserver(()=>{pe(o,o.__value)});v.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),De(()=>{v.disconnect()})}function He(o,v,c=v){var p=new WeakSet,f=!0;Ce(o,"change",u=>{var b=u?"[selected]":":checked",m;if(o.multiple)m=[].map.call(o.querySelectorAll(b),K);else{var y=o.querySelector(b)??o.querySelector("option:not([disabled])");m=y&&K(y)}c(m),N!==null&&p.add(N)}),ve(()=>{var u=v();if(o===document.activeElement){var b=Oe??N;if(p.has(b))return}if(pe(o,u,f),f&&u===void 0){var m=o.querySelector(":checked");m!==null&&(u=K(m),c(u))}o.__value=u,f=!1}),Ge(o)}function K(o){return"__value"in o?o.__value:o.value}var ze=D(`<div class="space-y-3"><div class="flex items-center gap-2 p-3 bg-surface-900 rounded-lg border border-amber-500/20"><code class="flex-1 text-sm font-mono text-amber-300 break-all"> </code> <!></div> <div class="flex items-center justify-between"><p class="text-xs text-amber-400/70">Copy this key now. It won't be shown again.</p> <button class="text-xs text-slate-500 hover:text-slate-300 transition-colors">Done</button></div></div>`),Ue=D('<div class="flex items-center gap-3"><input type="text" class="flex-1 px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-slate-200 placeholder:text-surface-600 focus:outline-none focus:border-accent-500/50" placeholder="Key name (e.g., Claude Code)"/> <button class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-accent-500 text-surface-950 font-medium text-sm hover:bg-accent-400 disabled:opacity-40 transition-colors"> </button></div>'),We=D('<div class="text-slate-600"> </div>'),Ne=D('<div class="flex items-center justify-between px-5 py-3 hover:bg-surface-800/20 transition-colors"><div class="flex items-center gap-4"><div class="w-8 h-8 rounded-lg bg-surface-800 flex items-center justify-center"><svg class="w-4 h-4 text-accent-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"></path></svg></div> <div><div class="text-sm font-medium text-slate-200"> </div> <div class="text-xs font-mono text-slate-500"> </div></div></div> <div class="flex items-center gap-6"><div class="text-right text-xs"><div class="text-slate-500"> </div> <!></div> <button class="text-xs text-rose-400/60 hover:text-rose-400 transition-colors px-2 py-1 rounded hover:bg-rose-500/10">Revoke</button></div></div>'),Je=D('<div class="px-5 py-8 text-center text-sm text-slate-500">No API keys generated yet. Create one above to secure your endpoint.</div>'),Ve=D('<tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 text-slate-400 whitespace-nowrap"> </td><td class="px-4 py-2.5 font-mono text-slate-300"> </td><td class="px-4 py-2.5 font-mono text-amber-300/80"> </td><td class="px-4 py-2.5 font-mono text-slate-400"> </td><td class="px-4 py-2.5 text-slate-400"> </td><td class="px-4 py-2.5 text-right font-mono text-slate-500"> </td><td class="px-4 py-2.5 text-center"><span></span></td></tr>'),Ye=D('<div class="space-y-8"><div><h1 class="text-2xl font-semibold text-slate-100 tracking-tight">Security</h1> <p class="mt-1 text-sm text-slate-400">API keys, access control, and audit logs</p></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl p-5"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider mb-4">Access Mode</h2> <div class="flex items-center gap-4"><div class="flex items-center gap-2 px-4 py-2 rounded-lg bg-emerald-500/10 border border-emerald-500/20"><svg class="w-5 h-5 text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"></path></svg> <span class="text-sm font-medium text-emerald-400">Read Only</span></div> <span class="text-xs text-slate-500">Only SELECT queries are permitted. Write operations are blocked.</span></div></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl overflow-hidden"><div class="px-5 py-4 border-b border-surface-700/50"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">API Keys</h2></div> <div class="px-5 py-4 border-b border-surface-700/30 bg-surface-800/30"><!></div> <div class="divide-y divide-surface-800/50"><!> <!></div></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl p-5"><div class="flex items-center justify-between mb-3"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">Roles & Permissions</h2> <span class="px-2 py-0.5 rounded text-[10px] font-medium bg-surface-800 text-slate-500 border border-surface-700/50 uppercase tracking-wider">Coming Soon</span></div> <p class="text-sm text-slate-500">Fine-grained role-based access control for multi-user deployments.</p></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl overflow-hidden"><div class="flex items-center justify-between px-5 py-4 border-b border-surface-700/50"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">Audit Log</h2> <div class="flex items-center gap-2"><input type="text" class="px-3 py-1.5 bg-surface-800 border border-surface-700 rounded-lg text-xs text-slate-300 placeholder:text-surface-600 focus:outline-none focus:border-accent-500/50 w-32" placeholder="Filter tool..."/> <select class="px-3 py-1.5 bg-surface-800 border border-surface-700 rounded-lg text-xs text-slate-300 focus:outline-none focus:border-accent-500/50 appearance-none cursor-pointer"><option>All status</option><option>Success</option><option>Error</option></select></div></div> <div class="overflow-x-auto"><table class="w-full text-xs"><thead><tr class="bg-surface-800/30"><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Time</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Action</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Tool</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Table</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Client</th><th class="px-4 py-2.5 text-right text-slate-500 font-medium uppercase tracking-wider">Duration</th><th class="px-4 py-2.5 text-center text-slate-500 font-medium uppercase tracking-wider">Status</th></tr></thead><tbody class="divide-y divide-surface-800/30"></tbody></table></div></div></div>');function it(o,v){Te(v,!0);let c=C(le([])),p=C(le([])),f=C(""),u=C(""),b=C(!1),m=C(""),y=C("");const V=[{id:"1",name:"Claude Code",prefix:"cdt_a8f2...",created_at:"2026-02-24T10:00:00Z",last_used:"2026-02-24T14:30:00Z",expires_at:null},{id:"2",name:"Cursor Dev",prefix:"cdt_9e1c...",created_at:"2026-02-23T09:00:00Z",last_used:"2026-02-24T12:15:00Z",expires_at:"2026-03-23T09:00:00Z"}],Y=[{id:"1",timestamp:new Date(Date.now()-6e4).toISOString(),action:"tool_call",tool:"query",table:"users",client:"claude-code",duration_ms:12,status:"success",details:"SELECT * FROM users WHERE id = $1"},{id:"2",timestamp:new Date(Date.now()-12e4).toISOString(),action:"tool_call",tool:"describe_table",table:"orders",client:"claude-code",duration_ms:3,status:"success",details:""},{id:"3",timestamp:new Date(Date.now()-18e4).toISOString(),action:"tool_call",tool:"query",table:"products",client:"cursor",duration_ms:45,status:"success",details:"SELECT name, price FROM products ORDER BY price DESC LIMIT 10"},{id:"4",timestamp:new Date(Date.now()-24e4).toISOString(),action:"tool_call",tool:"query",table:"analytics",client:"claude-code",duration_ms:230,status:"error",details:'ERROR: relation "analytics" does not exist'},{id:"5",timestamp:new Date(Date.now()-3e5).toISOString(),action:"tool_call",tool:"list_tables",table:"",client:"vscode",duration_ms:8,status:"success",details:""},{id:"6",timestamp:new Date(Date.now()-6e5).toISOString(),action:"auth",tool:"",table:"",client:"unknown",duration_ms:0,status:"error",details:"Invalid API key"}];Ee(()=>{Q()});async function Q(){try{const[e,a]=await Promise.allSettled([$e(),Fe()]);e.status==="fulfilled"?d(c,e.value,!0):d(c,V,!0),a.status==="fulfilled"?d(p,a.value,!0):d(p,Y,!0)}catch{d(c,V,!0),d(p,Y,!0)}}async function fe(){if(t(f)){d(b,!0);try{const e=await Ze(t(f));d(u,e.key,!0),await Q()}catch{const e="abcdefghijklmnopqrstuvwxyz0123456789";let a="cdt_";for(let l=0;l<32;l++)a+=e[Math.floor(Math.random()*e.length)];d(u,a,!0),d(c,[...t(c),{id:crypto.randomUUID(),name:t(f),prefix:a.substring(0,8)+"...",created_at:new Date().toISOString(),last_used:null,expires_at:null}],!0)}d(b,!1),d(f,"")}}async function xe(e){try{await Be(e)}catch{}d(c,t(c).filter(a=>a.id!==e),!0)}function q(e){try{return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}const me=qe(()=>t(p).filter(e=>!(t(m)&&!e.tool.toLowerCase().includes(t(m).toLowerCase())||t(y)&&e.status!==t(y))));var M=Ye();Pe("4rm2pb",e=>{ve(()=>{Re.title="Security — Conduit"})});var j=i(s(M),4),P=i(s(j),2),_e=s(P);{var be=e=>{var a=ze(),l=s(a),n=s(l),g=s(n,!0);r(n);var _=i(n,2);Me(_,{get text(){return t(u)}}),r(l);var A=i(l,2),h=i(s(A),2);r(A),r(a),E(()=>x(g,t(u))),W("click",h,()=>d(u,"")),S(e,a)},ge=e=>{var a=Ue(),l=s(a);ce(l);var n=i(l,2),g=s(n,!0);r(n),r(a),E(()=>{n.disabled=!t(f)||t(b),x(g,t(b)?"Generating...":"Generate Key")}),ue(l,()=>t(f),_=>d(f,_)),W("click",n,fe),S(e,a)};J(_e,e=>{t(u)?e(be):e(ge,!1)})}r(P);var X=i(P,2),ee=s(X);de(ee,17,()=>t(c),ne,(e,a)=>{var l=Ne(),n=s(l),g=i(s(n),2),_=s(g),A=s(_,!0);r(_);var h=i(_,2),H=s(h,!0);r(h),r(g),r(n);var I=i(n,2),L=s(I),w=s(L),z=s(w);r(w);var O=i(w,2);{var U=k=>{var T=We(),we=s(T);r(T),E(ke=>x(we,`Last used ${ke??""}`),[()=>q(t(a).last_used)]),S(k,T)};J(O,k=>{t(a).last_used&&k(U)})}r(L);var R=i(L,2);r(I),r(l),E(k=>{x(A,t(a).name),x(H,t(a).prefix),x(z,`Created ${k??""}`)},[()=>q(t(a).created_at)]),W("click",R,()=>xe(t(a).id)),S(e,l)});var he=i(ee,2);{var ye=e=>{var a=Je();S(e,a)};J(he,e=>{t(c).length===0&&e(ye)})}r(X),r(j);var te=i(j,4),$=s(te),ae=i(s($),2),F=s(ae);ce(F);var Z=i(F,2),B=s(Z);B.value=B.__value="";var G=i(B);G.value=G.__value="success";var re=i(G);re.value=re.__value="error",r(Z),r(ae),r($);var se=i($,2),ie=s(se),oe=i(s(ie));de(oe,21,()=>t(me),ne,(e,a)=>{var l=Ve(),n=s(l),g=s(n,!0);r(n);var _=i(n),A=s(_,!0);r(_);var h=i(_),H=s(h,!0);r(h);var I=i(h),L=s(I,!0);r(I);var w=i(I),z=s(w,!0);r(w);var O=i(w),U=s(O,!0);r(O);var R=i(O),k=s(R);r(R),r(l),E(T=>{x(g,T),x(A,t(a).action),x(H,t(a).tool||"—"),x(L,t(a).table||"—"),x(z,t(a).client),x(U,t(a).duration_ms>0?t(a).duration_ms+"ms":"—"),je(k,1,`inline-flex w-2 h-2 rounded-full ${t(a).status==="success"?"bg-emerald-400":"bg-rose-400"}`)},[()=>q(t(a).timestamp)]),S(e,l)}),r(oe),r(ie),r(se),r(te),r(M),ue(F,()=>t(m),e=>d(m,e)),He(Z,()=>t(y),e=>d(y,e)),S(o,M),Ke()}Se(["click"]);export{it as component};
