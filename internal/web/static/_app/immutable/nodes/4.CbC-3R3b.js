import{d as je,c as R,a as _,f as y,s as f}from"../chunks/Bph8Cap9.js";import{l as $e,k as ee,e as we,G as Be,I as Fe,J as Ze,K as Ge,w as He,p as ze,b as k,d as be,h as Ue,i as l,t as E,g as a,a as We,c as s,s as o,$ as Ne,r as t,n as j,u as Je}from"../chunks/B8-RBE8K.js";import{i as $}from"../chunks/Cv1hhGhC.js";import{e as ge,i as _e,r as ye,b as te,C as Ve}from"../chunks/DhYmL2PG.js";import{h as Ye}from"../chunks/DN4icXi7.js";import{b as he}from"../chunks/ByCfWYC6.js";import{c as Qe,d as Xe,g as et,e as tt}from"../chunks/EFiNwc8y.js";function ke(d,p,c=!1){if(d.multiple){if(p==null)return;if(!Fe(p))return Ze();for(var x of d.options)x.selected=p.includes(P(x));return}for(x of d.options){var v=P(x);if(Ge(v,p)){x.selected=!0;return}}(!c||p!==void 0)&&(d.selectedIndex=-1)}function at(d){var p=new MutationObserver(()=>{ke(d,d.__value)});p.observe(d,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Be(()=>{p.disconnect()})}function st(d,p,c=p){var x=new WeakSet,v=!0;$e(d,"change",u=>{var g=u?"[selected]":":checked",m;if(d.multiple)m=[].map.call(d.querySelectorAll(g),P);else{var S=d.querySelector(g)??d.querySelector("option:not([disabled])");m=S&&P(S)}c(m),ee!==null&&x.add(ee)}),we(()=>{var u=p();if(d===document.activeElement){var g=He??ee;if(x.has(g))return}if(ke(d,u,v),v&&u===void 0){var m=d.querySelector(":checked");m!==null&&(u=P(m),c(u))}d.__value=u,v=!1}),at(d)}function P(d){return"__value"in d?d.__value:d.value}var rt=y(`<div class="space-y-3"><div class="flex items-center gap-2 p-3 bg-surface-900 rounded-lg border border-amber-500/20"><code class="flex-1 text-sm font-mono text-amber-300 break-all"> </code> <!></div> <div class="flex items-center justify-between"><p class="text-xs text-amber-400/70">Copy this key now. It won't be shown again.</p> <button class="text-xs text-slate-500 hover:text-slate-300 transition-colors">Done</button></div></div>`),ot=y('<div class="flex items-center gap-3"><input type="text" class="flex-1 px-3 py-2 bg-surface-800 border border-surface-700 rounded-lg text-sm text-slate-200 placeholder:text-surface-600 focus:outline-none focus:border-accent-500/50" placeholder="Key name (e.g., Claude Code)"/> <button class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-accent-500 text-surface-950 font-medium text-sm hover:bg-accent-400 disabled:opacity-40 transition-colors"> </button></div>'),dt=y('<div class="text-slate-600"> </div>'),it=y('<div class="flex items-center justify-between px-5 py-3 hover:bg-surface-800/20 transition-colors"><div class="flex items-center gap-4"><div class="w-8 h-8 rounded-lg bg-surface-800 flex items-center justify-center"><svg class="w-4 h-4 text-accent-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"></path></svg></div> <div><div class="text-sm font-medium text-slate-200"> </div> <div class="text-xs font-mono text-slate-500"> </div></div></div> <div class="flex items-center gap-6"><div class="text-right text-xs"><div class="text-slate-500"> </div> <!></div> <button class="text-xs text-rose-400/60 hover:text-rose-400 transition-colors px-2 py-1 rounded hover:bg-rose-500/10">Revoke</button></div></div>'),lt=y('<div class="px-5 py-8 text-center text-sm text-slate-500">No API keys generated yet. Create one above to secure your endpoint.</div>'),nt=y('PII masking is <span class="text-accent-500 font-medium">enabled</span>. Sensitive columns are automatically detected and masked in query results.',1),ct=y('PII masking is <span class="text-rose-400 font-medium">disabled</span>. All column values are returned unmasked.',1),ut=y('<tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 text-slate-400 whitespace-nowrap"> </td><td class="px-4 py-2.5 font-mono text-slate-300"> </td><td class="px-4 py-2.5 font-mono text-amber-300/80"> </td><td class="px-4 py-2.5 font-mono text-slate-400"> </td><td class="px-4 py-2.5 text-slate-400"> </td><td class="px-4 py-2.5 text-right font-mono text-slate-500"> </td><td class="px-4 py-2.5 text-center"><span></span></td></tr>'),pt=y('<div class="space-y-8"><div><h1 class="text-2xl font-semibold text-slate-100 tracking-tight">Security</h1> <p class="mt-1 text-sm text-slate-400">API keys, access control, and audit logs</p></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl p-5"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider mb-4">Access Mode</h2> <div class="flex items-center gap-4"><div class="flex items-center gap-2 px-4 py-2 rounded-lg bg-emerald-500/10 border border-emerald-500/20"><svg class="w-5 h-5 text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"></path></svg> <span class="text-sm font-medium text-emerald-400">Read Only</span></div> <span class="text-xs text-slate-500">Only SELECT queries are permitted. Write operations are blocked.</span></div></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl overflow-hidden"><div class="px-5 py-4 border-b border-surface-700/50"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">API Keys</h2></div> <div class="px-5 py-4 border-b border-surface-700/30 bg-surface-800/30"><!></div> <div class="divide-y divide-surface-800/50"><!> <!></div></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl overflow-hidden"><div class="flex items-center justify-between px-5 py-4 border-b border-surface-700/50"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">PII Masking</h2> <button aria-label="Toggle PII masking"><span></span></button></div> <div class="px-5 py-4 border-b border-surface-700/30 bg-surface-800/30"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-accent-400 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"></path></svg> <div><p class="text-sm text-slate-300"><!></p> <p class="text-xs text-slate-500 mt-1">Equivalent to the <code class="text-accent-500/80 bg-surface-800 px-1.5 py-0.5 rounded font-mono text-[11px]">--mask-pii</code> flag</p></div></div></div> <div class="overflow-x-auto"><table class="w-full text-xs"><thead><tr class="bg-surface-800/30"><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Column Pattern</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Matches</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Action</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Example Output</th></tr></thead><tbody class="divide-y divide-surface-800/30"><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*email*</td><td class="px-4 py-2.5 text-slate-400">Email addresses</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-amber-500/10 text-amber-400 border border-amber-500/20 uppercase tracking-wider">Masked</span></td><td class="px-4 py-2.5 font-mono text-slate-300">k***@example.com</td></tr><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*phone*, *mobile*</td><td class="px-4 py-2.5 text-slate-400">Phone numbers</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-amber-500/10 text-amber-400 border border-amber-500/20 uppercase tracking-wider">Masked</span></td><td class="px-4 py-2.5 font-mono text-slate-300">***-***-1234</td></tr><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*ssn*</td><td class="px-4 py-2.5 text-slate-400">Social Security numbers</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-amber-500/10 text-amber-400 border border-amber-500/20 uppercase tracking-wider">Masked</span></td><td class="px-4 py-2.5 font-mono text-slate-300">***-**-6789</td></tr><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*card_number*</td><td class="px-4 py-2.5 text-slate-400">Credit card numbers</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-amber-500/10 text-amber-400 border border-amber-500/20 uppercase tracking-wider">Masked</span></td><td class="px-4 py-2.5 font-mono text-slate-300">****-****-****-1234</td></tr><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*password*, *secret*</td><td class="px-4 py-2.5 text-slate-400">Passwords and secrets</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-rose-500/10 text-rose-400 border border-rose-500/20 uppercase tracking-wider">Excluded</span></td><td class="px-4 py-2.5 text-slate-500 italic">Column hidden entirely</td></tr><tr class="hover:bg-surface-800/20 transition-colors"><td class="px-4 py-2.5 font-mono text-accent-500">*token*, *api_key*</td><td class="px-4 py-2.5 text-slate-400">Tokens and API keys</td><td class="px-4 py-2.5"><span class="px-2 py-0.5 rounded text-[10px] font-medium bg-rose-500/10 text-rose-400 border border-rose-500/20 uppercase tracking-wider">Excluded</span></td><td class="px-4 py-2.5 text-slate-500 italic">Column hidden entirely</td></tr></tbody></table></div></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl p-5"><div class="flex items-center justify-between mb-3"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">Roles & Permissions</h2> <span class="px-2 py-0.5 rounded text-[10px] font-medium bg-surface-800 text-slate-500 border border-surface-700/50 uppercase tracking-wider">Coming Soon</span></div> <p class="text-sm text-slate-500">Fine-grained role-based access control for multi-user deployments.</p></div> <div class="bg-surface-900 border border-surface-700/50 rounded-xl overflow-hidden"><div class="flex items-center justify-between px-5 py-4 border-b border-surface-700/50"><h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider">Audit Log</h2> <div class="flex items-center gap-2"><input type="text" class="px-3 py-1.5 bg-surface-800 border border-surface-700 rounded-lg text-xs text-slate-300 placeholder:text-surface-600 focus:outline-none focus:border-accent-500/50 w-32" placeholder="Filter tool..."/> <select class="px-3 py-1.5 bg-surface-800 border border-surface-700 rounded-lg text-xs text-slate-300 focus:outline-none focus:border-accent-500/50 appearance-none cursor-pointer"><option>All status</option><option>Success</option><option>Error</option></select></div></div> <div class="overflow-x-auto"><table class="w-full text-xs"><thead><tr class="bg-surface-800/30"><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Time</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Action</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Tool</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Table</th><th class="px-4 py-2.5 text-left text-slate-500 font-medium uppercase tracking-wider">Client</th><th class="px-4 py-2.5 text-right text-slate-500 font-medium uppercase tracking-wider">Duration</th><th class="px-4 py-2.5 text-center text-slate-500 font-medium uppercase tracking-wider">Status</th></tr></thead><tbody class="divide-y divide-surface-800/30"></tbody></table></div></div></div>');function yt(d,p){ze(p,!0);let c=k(be([])),x=k(be([])),v=k(""),u=k(""),g=k(!1),m=k(""),S=k(""),L=k(!0);const ae=[{id:"1",name:"Claude Code",prefix:"cdt_a8f2...",created_at:"2026-02-24T10:00:00Z",last_used:"2026-02-24T14:30:00Z",expires_at:null},{id:"2",name:"Cursor Dev",prefix:"cdt_9e1c...",created_at:"2026-02-23T09:00:00Z",last_used:"2026-02-24T12:15:00Z",expires_at:"2026-03-23T09:00:00Z"}],se=[{id:"1",timestamp:new Date(Date.now()-6e4).toISOString(),action:"tool_call",tool:"query",table:"users",client:"claude-code",duration_ms:12,status:"success",details:"SELECT * FROM users WHERE id = $1"},{id:"2",timestamp:new Date(Date.now()-12e4).toISOString(),action:"tool_call",tool:"describe_table",table:"orders",client:"claude-code",duration_ms:3,status:"success",details:""},{id:"3",timestamp:new Date(Date.now()-18e4).toISOString(),action:"tool_call",tool:"query",table:"products",client:"cursor",duration_ms:45,status:"success",details:"SELECT name, price FROM products ORDER BY price DESC LIMIT 10"},{id:"4",timestamp:new Date(Date.now()-24e4).toISOString(),action:"tool_call",tool:"query",table:"analytics",client:"claude-code",duration_ms:230,status:"error",details:'ERROR: relation "analytics" does not exist'},{id:"5",timestamp:new Date(Date.now()-3e5).toISOString(),action:"tool_call",tool:"list_tables",table:"",client:"vscode",duration_ms:8,status:"success",details:""},{id:"6",timestamp:new Date(Date.now()-6e5).toISOString(),action:"auth",tool:"",table:"",client:"unknown",duration_ms:0,status:"error",details:"Invalid API key"}];Ue(()=>{re()});async function re(){try{const[e,r]=await Promise.allSettled([Qe(),Xe()]);e.status==="fulfilled"?l(c,e.value,!0):l(c,ae,!0),r.status==="fulfilled"?l(x,r.value,!0):l(x,se,!0)}catch{l(c,ae,!0),l(x,se,!0)}}async function Se(){if(a(v)){l(g,!0);try{const e=await et(a(v));l(u,e.key,!0),await re()}catch{const e="abcdefghijklmnopqrstuvwxyz0123456789";let r="cdt_";for(let i=0;i<32;i++)r+=e[Math.floor(Math.random()*e.length)];l(u,r,!0),l(c,[...a(c),{id:crypto.randomUUID(),name:a(v),prefix:r.substring(0,8)+"...",created_at:new Date().toISOString(),last_used:null,expires_at:null}],!0)}l(g,!1),l(v,"")}}async function Ce(e){try{await tt(e)}catch{}l(c,a(c).filter(r=>r.id!==e),!0)}function B(e){try{return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}const Ie=Je(()=>a(x).filter(e=>!(a(m)&&!e.tool.toLowerCase().includes(a(m).toLowerCase())||a(S)&&e.status!==a(S))));var F=pt();Ye("4rm2pb",e=>{we(()=>{Ne.title="Security — Conduit"})});var Z=o(s(F),4),G=o(s(Z),2),Ae=s(G);{var De=e=>{var r=rt(),i=s(r),n=s(i),h=s(n,!0);t(n);var b=o(n,2);Ve(b,{get text(){return a(u)}}),t(i);var A=o(i,2),w=o(s(A),2);t(A),t(r),E(()=>f(h,a(u))),R("click",w,()=>l(u,"")),_(e,r)},Ee=e=>{var r=ot(),i=s(r);ye(i);var n=o(i,2),h=s(n,!0);t(n),t(r),E(()=>{n.disabled=!a(v)||a(g),f(h,a(g)?"Generating...":"Generate Key")}),he(i,()=>a(v),b=>l(v,b)),R("click",n,Se),_(e,r)};$(Ae,e=>{a(u)?e(De):e(Ee,!1)})}t(G);var oe=o(G,2),de=s(oe);ge(de,17,()=>a(c),_e,(e,r)=>{var i=it(),n=s(i),h=o(s(n),2),b=s(h),A=s(b,!0);t(b);var w=o(b,2),Y=s(w,!0);t(w),t(h),t(n);var D=o(n,2),M=s(D),C=s(M),Q=s(C);t(C);var T=o(C,2);{var X=I=>{var O=dt(),Ke=s(O);t(O),E(Re=>f(Ke,`Last used ${Re??""}`),[()=>B(a(r).last_used)]),_(I,O)};$(T,I=>{a(r).last_used&&I(X)})}t(M);var K=o(M,2);t(D),t(i),E(I=>{f(A,a(r).name),f(Y,a(r).prefix),f(Q,`Created ${I??""}`)},[()=>B(a(r).created_at)]),R("click",K,()=>Ce(a(r).id)),_(e,i)});var Le=o(de,2);{var Me=e=>{var r=lt();_(e,r)};$(Le,e=>{a(c).length===0&&e(Me)})}t(oe),t(Z);var H=o(Z,2),z=s(H),q=o(s(z),2),Te=s(q);t(q),t(z);var ie=o(z,2),le=s(ie),ne=o(s(le),2),ce=s(ne),Oe=s(ce);{var Pe=e=>{var r=nt();j(2),_(e,r)},qe=e=>{var r=ct();j(2),_(e,r)};$(Oe,e=>{a(L)?e(Pe):e(qe,!1)})}t(ce),j(2),t(ne),t(le),t(ie),j(2),t(H);var ue=o(H,4),U=s(ue),pe=o(s(U),2),W=s(pe);ye(W);var N=o(W,2),J=s(N);J.value=J.__value="";var V=o(J);V.value=V.__value="success";var xe=o(V);xe.value=xe.__value="error",t(N),t(pe),t(U);var ve=o(U,2),fe=s(ve),me=o(s(fe));ge(me,21,()=>a(Ie),_e,(e,r)=>{var i=ut(),n=s(i),h=s(n,!0);t(n);var b=o(n),A=s(b,!0);t(b);var w=o(b),Y=s(w,!0);t(w);var D=o(w),M=s(D,!0);t(D);var C=o(D),Q=s(C,!0);t(C);var T=o(C),X=s(T,!0);t(T);var K=o(T),I=s(K);t(K),t(i),E(O=>{f(h,O),f(A,a(r).action),f(Y,a(r).tool||"—"),f(M,a(r).table||"—"),f(Q,a(r).client),f(X,a(r).duration_ms>0?a(r).duration_ms+"ms":"—"),te(I,1,`inline-flex w-2 h-2 rounded-full ${a(r).status==="success"?"bg-emerald-400":"bg-rose-400"}`)},[()=>B(a(r).timestamp)]),_(e,i)}),t(me),t(fe),t(ve),t(ue),t(F),E(()=>{te(q,1,`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a(L)?"bg-accent-500":"bg-surface-700"}`),te(Te,1,`inline-block h-4 w-4 rounded-full bg-white transition-transform ${a(L)?"translate-x-6":"translate-x-1"}`)}),R("click",q,()=>l(L,!a(L))),he(W,()=>a(m),e=>l(m,e)),st(N,()=>a(S),e=>l(S,e)),_(d,F),We()}je(["click"]);export{yt as component};
